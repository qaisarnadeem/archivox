
<div class="question-index">
<div class="question-form">
<%= form_for @question,:html => { :class => "form-horizontal event_session" ,'data-parsley-validate'=>''} do |f| %>
    <div class="form-group search-box">
      <div class="col-lg-9 field-container">
        <%= f.text_field :description,:placeholder=>'Ask a question...', :class => 'form-control search-field' ,'data-parsley-required'=>'','data-parsley-trigger'=>'change','data-parsley-min-length'=>6%>
      </div>
      <div>
        <%= submit_tag 'Ask', :class => 'btn btn-primary btn-lg submit-btn purple-submit' %>
      </div>
    </div>
<% end %>
</div>
<ul class="list-unstyled clearfix question-outer">

  <%@questions.each do  |question| %>

      <li class="question clearfix">
        <span class="col-lg-2 text-center">
          <a class="vote-up" href="javascript:void(0)" question_id="<%=question.id%>">
            <span class="arrow">vote up</span></a><br>
          <span class="vote-count"><%=question.vote_count%></span>
        </span>
        <h3 class="col-lg-10"><%=question.description%></h3>

      </li>
  <%end%>
</ul>




<script type="text/javascript">
  $(function(){
    $('.vote-up').click(function(){
      $.ajax({url:['/questions/',$(this).attr('question_id'),'/vote_up'].join('')
      });
      set_count(this);
    });
  });

  function  get_count(elem){
      return parseInt($(elem).parents('.question').find('.vote-count').text());
    }
    function  set_count(elem){
      var parent=$(elem).parents('.question');
      parent.find('.vote-count').text(get_count(elem)+1);
       if(get_count(elem) > get_count(parent.prev().find('a'))){
         parent.prev().hasClass('question') ? parent.insertBefore(parent.prev()) : '';

       }


    }

</script>

